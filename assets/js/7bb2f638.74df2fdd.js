"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8659],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return g}});var a=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},u=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),m=p(t),g=l,d=m["".concat(s,".").concat(g)]||m[g]||c[g]||o;return t?a.createElement(d,r(r({ref:n},u),{},{components:t})):a.createElement(d,r({ref:n},u))}));function g(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var o=t.length,r=new Array(o);r[0]=m;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:l,r[1]=i;for(var p=2;p<o;p++)r[p]=t[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},4232:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return u},default:function(){return m}});var a=t(3117),l=t(102),o=(t(7294),t(3905)),r=["components"],i={id:"ecosystem-angular",title:"single-spa-angular",sidebar_label:"Angular"},s=void 0,p={unversionedId:"ecosystem-angular",id:"version-5.x/ecosystem-angular",title:"single-spa-angular",description:"Project Status",source:"@site/versioned_docs/version-5.x/ecosystem-angular.md",sourceDirName:".",slug:"/ecosystem-angular",permalink:"/docs/ecosystem-angular",editUrl:"https://github.com/single-spa/fr.single-spa.js.org/blob/master/website/versioned_docs/version-5.x/ecosystem-angular.md",tags:[],version:"5.x",frontMatter:{id:"ecosystem-angular",title:"single-spa-angular",sidebar_label:"Angular"},sidebar:"version-5.x/docs",previous:{title:"Vue",permalink:"/docs/ecosystem-vue"},next:{title:"AngularJS",permalink:"/docs/ecosystem-angularjs"}},u=[{value:"Project Status",id:"project-status",children:[],level:3},{value:"Introduction",id:"introduction",children:[{value:"Community",id:"community",children:[],level:3},{value:"Demo",id:"demo",children:[],level:3},{value:"Starter repo",id:"starter-repo",children:[],level:3},{value:"Contributing",id:"contributing",children:[],level:3}],level:2},{value:"Angular versions",id:"angular-versions",children:[{value:"Angular 1 (AngularJS)",id:"angular-1-angularjs",children:[],level:3},{value:"Angular 2",id:"angular-2",children:[],level:3},{value:"Angular 3",id:"angular-3",children:[],level:3},{value:"Angular 4",id:"angular-4",children:[],level:3},{value:"Angular 5",id:"angular-5",children:[],level:3},{value:"Angular 6",id:"angular-6",children:[],level:3},{value:"Angular 7",id:"angular-7",children:[],level:3},{value:"Angular 8",id:"angular-8",children:[],level:3},{value:"Angular 9",id:"angular-9",children:[],level:3},{value:"Angular 10",id:"angular-10",children:[],level:3},{value:"Angular 11",id:"angular-11",children:[],level:3},{value:"Angular 12",id:"angular-12",children:[],level:3}],level:2},{value:"Angular CLI",id:"angular-cli",children:[{value:"Installation",id:"installation",children:[],level:3},{value:"Schematics",id:"schematics",children:[],level:3},{value:"Finish installation",id:"finish-installation",children:[],level:3}],level:2},{value:"Manual Installation",id:"manual-installation",children:[{value:"Installation",id:"installation-1",children:[],level:3},{value:"Manually apply schematics",id:"manually-apply-schematics",children:[],level:3},{value:"Use Angular Builder",id:"use-angular-builder",children:[{value:"ng build options",id:"ng-build-options",children:[],level:5},{value:"ng serve options",id:"ng-serve-options",children:[],level:5}],level:3},{value:"Use Custom Webpack",id:"use-custom-webpack",children:[],level:3}],level:2},{value:"Routing",id:"routing",children:[{value:"Configure routes",id:"configure-routes",children:[],level:3},{value:"Linking between applications",id:"linking-between-applications",children:[],level:3},{value:"Nested routes",id:"nested-routes",children:[],level:3},{value:"Enabling hash mode",id:"enabling-hash-mode",children:[],level:3}],level:2},{value:"Serving",id:"serving",children:[],level:2},{value:"Building",id:"building",children:[],level:2},{value:"The single-spa helpers",id:"the-single-spa-helpers",children:[{value:"Introduction",id:"introduction-1",children:[],level:3},{value:"Migrating from single-spa-angular@3.x to single-spa-angular@4.x",id:"migrating-from-single-spa-angular3x-to-single-spa-angular4x",children:[{value:"Packages",id:"packages",children:[],level:4},{value:"API Updates",id:"api-updates",children:[],level:4}],level:3}],level:2},{value:"Basic usage",id:"basic-usage",children:[{value:"Full Example",id:"full-example",children:[],level:3},{value:"Options",id:"options",children:[],level:3}],level:2},{value:"Concepts",id:"concepts",children:[{value:"ZoneJS",id:"zonejs",children:[],level:3},{value:"Multiple applications",id:"multiple-applications",children:[],level:3},{value:"Custom Props",id:"custom-props",children:[],level:3},{value:"Angular assets",id:"angular-assets",children:[{value:"Within HTML templates",id:"within-html-templates",children:[{value:"Option 1",id:"option-1",children:[],level:5},{value:"Option 2",id:"option-2",children:[],level:5}],level:4}],level:3},{value:"Scripts",id:"scripts",children:[{value:"Option 1",id:"option-1-1",children:[],level:4},{value:"Option 2",id:"option-2-1",children:[],level:4}],level:3},{value:"Styles",id:"styles",children:[],level:3},{value:"Polyfills",id:"polyfills",children:[],level:3},{value:"Internet Explorer",id:"internet-explorer",children:[],level:3}],level:2},{value:"Shared Angular",id:"shared-angular",children:[],level:2},{value:"Angular Elements",id:"angular-elements",children:[],level:2},{value:"Parcels",id:"parcels",children:[{value:"Loading External Components Asynchronously",id:"loading-external-components-asynchronously",children:[],level:3},{value:"Passing Custom Props",id:"passing-custom-props",children:[],level:3}],level:2},{value:"Zone-less applications",id:"zone-less-applications",children:[{value:"Routing in zone-less applications",id:"routing-in-zone-less-applications",children:[],level:3}],level:2},{value:"Inter-app communication via RxJS",id:"inter-app-communication-via-rxjs",children:[],level:2}],c={toc:u};function m(e){var n=e.components,t=(0,l.Z)(e,r);return(0,o.kt)("wrapper",(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"project-status"},"Project Status"),(0,o.kt)("p",null,"The single-spa-angular project is overseen by the single-spa core team, but largely maintained by the community using it. This is because the single-spa core team is stronger in other frameworks and often doesn't have the expertise to fix bugs in a timely manner. There are a few community members who help us actively maintain the project, which we greatly appreciate. If you have Angular experience, we'd appreciate your help in maintaining the repo. To do so, set up notifications by watching the single-spa-angular Github repository. Also, please join the ",(0,o.kt)("inlineCode",{parentName:"p"},"#maintainers")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"#angular")," channels in Slack."),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/single-spa/single-spa-angular/"},"single-spa-angular")," is a library for creating Angular microfrontends."),(0,o.kt)("p",null,"Each microfrontend (",(0,o.kt)("a",{parentName:"p",href:"/docs/building-applications.html"},"single-spa application"),") is an Angular CLI project that can\nuse its own version of Angular and be deployed separately from any other. They all come together into a single\nweb page where one or more single-spa applications is active at any time."),(0,o.kt)("p",null,"The documentation here is extensive, so use the sidenav on the right. \ud83d\udc49\ud83d\udc49\ud83d\udc49"),(0,o.kt)("h3",{id:"community"},"Community"),(0,o.kt)("p",null,"Join the ",(0,o.kt)("inlineCode",{parentName:"p"},"#angular")," channel in ",(0,o.kt)("a",{parentName:"p",href:"https://join.slack.com/t/single-spa/shared_invite/zt-yxfqpl2u-PNx3uZtS3pgAXbOBWsdwOA"},"single-spa's Slack workspace"),"."),(0,o.kt)("h3",{id:"demo"},"Demo"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://coexisting-angular-microfrontends.surge.sh"},"https://coexisting-angular-microfrontends.surge.sh")),(0,o.kt)("h3",{id:"starter-repo"},"Starter repo"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/joeldenning/coexisting-angular-microfrontends"},"https://github.com/joeldenning/coexisting-angular-microfrontends")),(0,o.kt)("h3",{id:"contributing"},"Contributing"),(0,o.kt)("p",null,"For instructions on how to test this locally before creating a pull request, see the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/single-spa/single-spa-angular/blob/master/CONTRIBUTING.md"},"Contributing docs"),"."),(0,o.kt)("h2",{id:"angular-versions"},"Angular versions"),(0,o.kt)("h3",{id:"angular-1-angularjs"},"Angular 1 (AngularJS)"),(0,o.kt)("p",null,"AngularJS is supported by ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/single-spa/single-spa-angularjs"},"single-spa-angularjs"),", instead of single-spa-angular.\nSee ",(0,o.kt)("a",{parentName:"p",href:"/docs/ecosystem-angularjs.html"},"AngularJS docs"),"."),(0,o.kt)("h3",{id:"angular-2"},"Angular 2"),(0,o.kt)("p",null,"Angular 2 is supported by single-spa-angular@3."),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"#schematics"},"single-spa-angular schematics")," are not supported by Angular 2, so you'll have to\nfollow the ",(0,o.kt)("a",{parentName:"p",href:"#manual-installation"},"steps for manual installation"),". The\n",(0,o.kt)("a",{parentName:"p",href:"#the-single-spa-helpers"},"single-spa helpers")," work with Angular 2."),(0,o.kt)("h3",{id:"angular-3"},"Angular 3"),(0,o.kt)("p",null,"Angular 3 ",(0,o.kt)("a",{parentName:"p",href:"https://www.infoworld.com/article/3150716/forget-angular-3-google-skips-straight-to-angular-4.html"},"never existed"),"."),(0,o.kt)("h3",{id:"angular-4"},"Angular 4"),(0,o.kt)("p",null,"Angular 4 is supported by single-spa-angular@3."),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"#schematics"},"single-spa-angular schematics")," are not supported by Angular 4, so you'll have to\nfollow the ",(0,o.kt)("a",{parentName:"p",href:"#manual-installation"},"steps for manual installation"),". The\n",(0,o.kt)("a",{parentName:"p",href:"#the-single-spa-helpers"},"single-spa helpers")," work with Angular 4."),(0,o.kt)("h3",{id:"angular-5"},"Angular 5"),(0,o.kt)("p",null,"Angular 5 is supported by single-spa-angular@3."),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"#schematics"},"single-spa-angular schematics")," are not supported by Angular 5, so you'll have to\nfollow the ",(0,o.kt)("a",{parentName:"p",href:"#manual-installation"},"steps for manual installation"),". The\n",(0,o.kt)("a",{parentName:"p",href:"#the-single-spa-helpers"},"single-spa helpers")," work with Angular 5."),(0,o.kt)("h3",{id:"angular-6"},"Angular 6"),(0,o.kt)("p",null,"Angular 6 is supported by single-spa-angular@3."),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"#schematics"},"single-spa-angular schematics")," are not supported by Angular 6, so you'll have to\nfollow the ",(0,o.kt)("a",{parentName:"p",href:"#manual-installation"},"steps for manual installation"),". The\n",(0,o.kt)("a",{parentName:"p",href:"#the-single-spa-helpers"},"single-spa helpers")," work with Angular 6."),(0,o.kt)("h3",{id:"angular-7"},"Angular 7"),(0,o.kt)("p",null,"Angular 7 is supported by single-spa-angular@3."),(0,o.kt)("p",null,"Both the ",(0,o.kt)("a",{parentName:"p",href:"#schematics"},"single-spa-angular schematics")," and the ",(0,o.kt)("a",{parentName:"p",href:"#the-single-spa-helpers"},"single-spa helpers"),"\nwork with Angular 7. Follow the ",(0,o.kt)("a",{parentName:"p",href:"#angular-cli"},"Angular CLI instructions"),"."),(0,o.kt)("p",null,"Note that the schematics for Angular 7 use an ",(0,o.kt)("a",{parentName:"p",href:"#use-angular-builder"},"Angular Builder")," that is no longer\nused in the Angular 8 schematics."),(0,o.kt)("h3",{id:"angular-8"},"Angular 8"),(0,o.kt)("p",null,"Angular 8 is supported by single-spa-angular@3."),(0,o.kt)("p",null,"Both the ",(0,o.kt)("a",{parentName:"p",href:"#schematics"},"single-spa-angular schematics")," and the ",(0,o.kt)("a",{parentName:"p",href:"#the-single-spa-helpers"},"single-spa helpers"),"\nwork with Angular 8. Follow the ",(0,o.kt)("a",{parentName:"p",href:"#angular-cli"},"Angular CLI instructions"),"."),(0,o.kt)("p",null,"Note that the schematics for Angular 8 ",(0,o.kt)("a",{parentName:"p",href:"#angular-builder"},"do not use the custom Angular builder"),", but instead use\n",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@angular-builders/custom-webpack"},"@angular-builders/custom-webpack"),"."),(0,o.kt)("h3",{id:"angular-9"},"Angular 9"),(0,o.kt)("p",null,"Angular 9 is supported by single-spa-angular@4."),(0,o.kt)("p",null,"Both the ",(0,o.kt)("a",{parentName:"p",href:"#schematics"},"single-spa-angular schematics")," and the ",(0,o.kt)("a",{parentName:"p",href:"#the-single-spa-helpers"},"single-spa helpers"),"\nwork with Angular 9. Follow the ",(0,o.kt)("a",{parentName:"p",href:"#angular-cli"},"Angular CLI instructions"),"."),(0,o.kt)("p",null,"Note that the schematics for Angular 9 ",(0,o.kt)("a",{parentName:"p",href:"#angular-builder"},"do not use the custom Angular builder"),", but instead use\n",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@angular-builders/custom-webpack"},"@angular-builders/custom-webpack"),"."),(0,o.kt)("h3",{id:"angular-10"},"Angular 10"),(0,o.kt)("p",null,"Angular 10 is supported by single-spa-angular@4."),(0,o.kt)("p",null,"Both the ",(0,o.kt)("a",{parentName:"p",href:"#schematics"},"single-spa-angular schematics")," and the ",(0,o.kt)("a",{parentName:"p",href:"#the-single-spa-helpers"},"single-spa helpers"),"\nwork with Angular 10. Follow the ",(0,o.kt)("a",{parentName:"p",href:"#angular-cli"},"Angular CLI instructions"),"."),(0,o.kt)("p",null,"Note that the schematics for Angular 10 ",(0,o.kt)("a",{parentName:"p",href:"#angular-builder"},"do not use the custom Angular builder"),", but instead use\n",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@angular-builders/custom-webpack"},"@angular-builders/custom-webpack"),"."),(0,o.kt)("h3",{id:"angular-11"},"Angular 11"),(0,o.kt)("p",null,"Angular 11 is supported by single-spa-angular@4."),(0,o.kt)("p",null,"Both the ",(0,o.kt)("a",{parentName:"p",href:"#schematics"},"single-spa-angular schematics")," and the ",(0,o.kt)("a",{parentName:"p",href:"#the-single-spa-helpers"},"single-spa helpers"),"\nwork with Angular 11. Follow the ",(0,o.kt)("a",{parentName:"p",href:"#angular-cli"},"Angular CLI instructions"),"."),(0,o.kt)("p",null,"Note that the schematics for Angular 11 ",(0,o.kt)("a",{parentName:"p",href:"#angular-builder"},"do not use the custom Angular builder"),", but instead use\n",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@angular-builders/custom-webpack"},"@angular-builders/custom-webpack"),"."),(0,o.kt)("h3",{id:"angular-12"},"Angular 12"),(0,o.kt)("p",null,"Angular 12 is supported by single-spa-angular@5."),(0,o.kt)("p",null,"Both the ",(0,o.kt)("a",{parentName:"p",href:"#schematics"},"single-spa-angular schematics")," and the ",(0,o.kt)("a",{parentName:"p",href:"#the-single-spa-helpers"},"single-spa helpers"),"\nwork with Angular 12. Follow the ",(0,o.kt)("a",{parentName:"p",href:"#angular-cli"},"Angular CLI instructions"),"."),(0,o.kt)("h2",{id:"angular-cli"},"Angular CLI"),(0,o.kt)("p",null,"You may use Angular CLI and single-spa together with any version of Angular. However, the ",(0,o.kt)("a",{parentName:"p",href:"#schematics"},"Angular CLI schematics"),"\nonly work if you're using Angular >= 7. If you're using an older version of Angular, follow\nthe ",(0,o.kt)("a",{parentName:"p",href:"#manual-installation"},"manual installation instructions"),"."),(0,o.kt)("h3",{id:"installation"},"Installation"),(0,o.kt)("p",null,"First, create an angular application. This requires installing ",(0,o.kt)("a",{parentName:"p",href:"https://cli.angular.io/"},"Angular CLI"),". Note that the ",(0,o.kt)("inlineCode",{parentName:"p"},"--prefix"),"\nis important so that when you have multiple angular applications their component selectors won't have the same names."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"ng new my-app --routing --prefix my-app\ncd my-app\n")),(0,o.kt)("p",null,"In the root of your Angular CLI application run the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"ng add single-spa-angular\n")),(0,o.kt)("h3",{id:"schematics"},"Schematics"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://angular.io/guide/schematics"},"Angular schematics")," are processed when you run ",(0,o.kt)("inlineCode",{parentName:"p"},"ng add single-spa-angular"),"."),(0,o.kt)("p",null,"The single-spa-angular schematics perform the following tasks:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Install single-spa-angular."),(0,o.kt)("li",{parentName:"ul"},"Generate a ",(0,o.kt)("inlineCode",{parentName:"li"},"main.single-spa.ts")," in your project ",(0,o.kt)("inlineCode",{parentName:"li"},"src/"),"."),(0,o.kt)("li",{parentName:"ul"},"Generate ",(0,o.kt)("inlineCode",{parentName:"li"},"single-spa-props.ts")," in ",(0,o.kt)("inlineCode",{parentName:"li"},"src/single-spa/")),(0,o.kt)("li",{parentName:"ul"},"Generate ",(0,o.kt)("inlineCode",{parentName:"li"},"asset-url.ts")," in ",(0,o.kt)("inlineCode",{parentName:"li"},"src/single-spa/")),(0,o.kt)("li",{parentName:"ul"},"Generate an EmptyRouteComponent in ",(0,o.kt)("inlineCode",{parentName:"li"},"src/app/empty-route/"),", to be used in app-routing.module.ts."),(0,o.kt)("li",{parentName:"ul"},"Add an npm script ",(0,o.kt)("inlineCode",{parentName:"li"},"npm run build:single-spa"),"."),(0,o.kt)("li",{parentName:"ul"},"Add an npm script ",(0,o.kt)("inlineCode",{parentName:"li"},"npm run serve:single-spa"),"."),(0,o.kt)("li",{parentName:"ul"},"For Angular 7 only, create a new entry in the project's architect called ",(0,o.kt)("inlineCode",{parentName:"li"},"single-spa"),", which is\na preconfigured ",(0,o.kt)("a",{parentName:"li",href:"#angular-builder"},"Angular Builder"),".")),(0,o.kt)("h3",{id:"finish-installation"},"Finish installation"),(0,o.kt)("p",null,"Now you must ",(0,o.kt)("a",{parentName:"p",href:"#configure-routes"},"configure routes"),". Then you can ",(0,o.kt)("a",{parentName:"p",href:"#serving"},"serve")," and ",(0,o.kt)("a",{parentName:"p",href:"#building"},"build"),"."),(0,o.kt)("h2",{id:"manual-installation"},"Manual Installation"),(0,o.kt)("p",null,"The manual installation instructions should be used if you are not using Angular CLI or if you are using Angular 6 or older."),(0,o.kt)("h3",{id:"installation-1"},"Installation"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install --save single-spa-angular\n")),(0,o.kt)("h3",{id:"manually-apply-schematics"},"Manually apply schematics"),(0,o.kt)("p",null,"Since the single-spa-angular schematics didn't run, you'll need to make the following changes:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Create all of the files that would have been created by the schematic.\n",(0,o.kt)("a",{parentName:"li",href:"https://github.com/single-spa/single-spa-angular/tree/master/schematics/ng-add/_files"},"See schematics files"),".\nBe sure to get the files in the subdirectories, too."),(0,o.kt)("li",{parentName:"ol"},"Add ",(0,o.kt)("inlineCode",{parentName:"li"},"build:single-spa")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"serve:single-spa")," to the ",(0,o.kt)("a",{parentName:"li",href:"https://docs.npmjs.com/misc/scripts"},"scripts")," in your package.json.\n",(0,o.kt)("a",{parentName:"li",href:"https://github.com/single-spa/single-spa-angular/blob/master/schematics/ng-add/index.ts#L161"},"See ",(0,o.kt)("inlineCode",{parentName:"a"},"addNPMScripts")," function"),"."),(0,o.kt)("li",{parentName:"ol"},"Use the angular builder, as described in the next section.")),(0,o.kt)("h3",{id:"use-angular-builder"},"Use Angular Builder"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note that this only applies to Angular versions pre Angular 8"),". Up until Angular 8, we maintained an angular builder\nthat allowed us to control the webpack config, but since Angular 8 we use\n",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@angular-builders/custom-webpack"},"@angular-builders/custom-webpack")," instead. See ",(0,o.kt)("a",{parentName:"p",href:"#use-custom-webpack"},"documentation")," for\nusing the custom webpack builder with single-spa-angular and Angular 8+."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"If you installed this library with Angular 7 using the Angular Schematic, this is already configured and\nyou don't need to change it. Otherwise, you might need to do this manually.")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"If you don't use Angular CLI, skip this section.")),(0,o.kt)("p",null,"To build your Angular CLI application as a single-spa app do the following."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Open ",(0,o.kt)("inlineCode",{parentName:"li"},"angular.json")),(0,o.kt)("li",{parentName:"ul"},"Locate the project you wish to update."),(0,o.kt)("li",{parentName:"ul"},"Navigate to the ",(0,o.kt)("inlineCode",{parentName:"li"},"architect > build")," property."),(0,o.kt)("li",{parentName:"ul"},"Set the ",(0,o.kt)("inlineCode",{parentName:"li"},"builder")," property to ",(0,o.kt)("inlineCode",{parentName:"li"},"single-spa-angular:build"),"."),(0,o.kt)("li",{parentName:"ul"},"Run ",(0,o.kt)("inlineCode",{parentName:"li"},"ng build")," and verify your dist contains one asset, ",(0,o.kt)("inlineCode",{parentName:"li"},"main.js"),".")),(0,o.kt)("p",null,"Example Configuration:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "architect": {\n    "build": {\n      "builder": "single-spa-angular:build",\n      "options": {\n        "libraryName": "hello"\n      }\n    },\n    "serve": {\n      "builder": "single-spa-angular:dev-server",\n      "options": {}\n    }\n  }\n}\n')),(0,o.kt)("h5",{id:"ng-build-options"},"ng build options"),(0,o.kt)("p",null,"Configuration options are provided to the ",(0,o.kt)("inlineCode",{parentName:"p"},"architect.build.options")," section of your angular.json."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Name"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"),(0,o.kt)("th",{parentName:"tr",align:null},"Default Value"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"libraryName"),(0,o.kt)("td",{parentName:"tr",align:null},"(optional) Specify the name of the module"),(0,o.kt)("td",{parentName:"tr",align:null},"Angular CLI project name")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"libraryTarget"),(0,o.kt)("td",{parentName:"tr",align:null},"(optional) The type of library to build ",(0,o.kt)("a",{parentName:"td",href:"https://github.com/webpack/webpack/blob/master/declarations/WebpackOptions.d.ts#L1111"},"see available options")),(0,o.kt)("td",{parentName:"tr",align:null},'"UMD"')),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"singleSpaWebpackConfigPath"),(0,o.kt)("td",{parentName:"tr",align:null},"(optional) Path to partial webpack config to be merged with angular's config. Example: ",(0,o.kt)("inlineCode",{parentName:"td"},"extra-webpack.config.js")),(0,o.kt)("td",{parentName:"tr",align:null},"undefined")))),(0,o.kt)("h5",{id:"ng-serve-options"},"ng serve options"),(0,o.kt)("p",null,"Configuration options are provided to the ",(0,o.kt)("inlineCode",{parentName:"p"},"architect.serve.options")," section of your angular.json."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Name"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"),(0,o.kt)("th",{parentName:"tr",align:null},"Default Value"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"singleSpaWebpackConfigPath"),(0,o.kt)("td",{parentName:"tr",align:null},"(optional) Path to partial webpack config to be merged with angular's config. Example: ",(0,o.kt)("inlineCode",{parentName:"td"},"extra-webpack.config.js")),(0,o.kt)("td",{parentName:"tr",align:null},"undefined")))),(0,o.kt)("h3",{id:"use-custom-webpack"},"Use Custom Webpack"),(0,o.kt)("p",null,"Starting with Angular 8, single-spa-angular's schematics install and use ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/just-jeb/angular-builders/tree/master/packages/custom-webpack"},(0,o.kt)("inlineCode",{parentName:"a"},"@angular-builders/custom-webpack"))," to modify the webpack config. The schematics also create an ",(0,o.kt)("inlineCode",{parentName:"p"},"extra-webpack.config.js")," file in your project where you can modify the configuration further."),(0,o.kt)("p",null,"The extra-webpack.config.js file should include the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const singleSpaAngularWebpack = require('single-spa-angular/lib/webpack')\n  .default;\n\nmodule.exports = (config, options) => {\n  const singleSpaWebpackConfig = singleSpaAngularWebpack(config, options);\n\n  // Feel free to modify this webpack config however you'd like to\n  return singleSpaWebpackConfig;\n};\n")),(0,o.kt)("p",null,"Older versions of single-spa-angular@3 and single-spa-angular@4 created extra-webpack.config.js files that did not pass ",(0,o.kt)("inlineCode",{parentName:"p"},"options")," into ",(0,o.kt)("inlineCode",{parentName:"p"},"singleSpaAngularWebpack"),". When you upgrade to newer versions, you'll need to pass in the options as shown above."),(0,o.kt)("p",null,"In addition to modifying the webpack config directly, you may alter some of single-spa-angular's behavior by changing the angular.json. Configuration options are provided to the ",(0,o.kt)("inlineCode",{parentName:"p"},"architect.build.options.customWebpackConfig")," section of your angular.json."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Name"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"),(0,o.kt)("th",{parentName:"tr",align:null},"Default Value"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"path"),(0,o.kt)("td",{parentName:"tr",align:null},"(required) Path to the the above ",(0,o.kt)("inlineCode",{parentName:"td"},"extra-webpack.config.js")," file."),(0,o.kt)("td",{parentName:"tr",align:null},"N/A")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"libraryName"),(0,o.kt)("td",{parentName:"tr",align:null},"(optional) Specify the name of the module"),(0,o.kt)("td",{parentName:"tr",align:null},"Angular CLI project name")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"libraryTarget"),(0,o.kt)("td",{parentName:"tr",align:null},"(optional) The type of library to build ",(0,o.kt)("a",{parentName:"td",href:"https://github.com/webpack/webpack/blob/master/declarations/WebpackOptions.d.ts#L1111"},"see available options")),(0,o.kt)("td",{parentName:"tr",align:null},'"UMD"')))),(0,o.kt)("p",null,"If you're using SystemJS, you may want to consider changing the ",(0,o.kt)("a",{parentName:"p",href:"https://webpack.js.org/configuration/output/#outputlibrarytarget"},"webpack output.libraryTarget")," to be ",(0,o.kt)("inlineCode",{parentName:"p"},'"system"'),", for better interop with SystemJS."),(0,o.kt)("h2",{id:"routing"},"Routing"),(0,o.kt)("h3",{id:"configure-routes"},"Configure routes"),(0,o.kt)("p",null,"To get single-spa working, you'll need to manually modify a few files."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Add ",(0,o.kt)("inlineCode",{parentName:"li"},"providers: [{ provide: APP_BASE_HREF, useValue: '/' }]")," to ",(0,o.kt)("inlineCode",{parentName:"li"},"app-routing.module.ts"),". See\n",(0,o.kt)("a",{parentName:"li",href:"https://angular.io/api/common/APP_BASE_HREF"},"angular docs")," for more details about APP_BASE_HREF."),(0,o.kt)("li",{parentName:"ol"},"Add ",(0,o.kt)("inlineCode",{parentName:"li"},"{ path: '**', component: EmptyRouteComponent }")," to your ",(0,o.kt)("inlineCode",{parentName:"li"},"app-routing.module.ts")," routes. The EmptyRouteComponent is part of the\nsingle-spa-angular schematics. This route makes sure that when single-spa is transitioning between routes that your Angular application\ndoesn't try to show a 404 page or throw an error. See ",(0,o.kt)("a",{parentName:"li",href:"https://angular.io/guide/router#configuration"},"angular docs")," for more details about routes."),(0,o.kt)("li",{parentName:"ol"},"Add a declaration for EmptyRouteComponent in ",(0,o.kt)("inlineCode",{parentName:"li"},"app.module.ts"),". See ",(0,o.kt)("a",{parentName:"li",href:"https://angular.io/guide/ngmodules#the-basic-ngmodule"},"angular docs")," for\nmore details about app.module.ts.")),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("strong",{parentName:"p"},"APP_BASE_HREF")," should have the same value that the used url for mount the Angular app defined in the single-spa root application. But doing this causes strange behaviours in Angular Router when navigate between registered apps."),(0,o.kt)("p",{parentName:"div"},"In order to avoid this is recommended using ",(0,o.kt)("strong",{parentName:"p"},"'/'")," as ",(0,o.kt)("strong",{parentName:"p"},"APP_BASE_HREF")," and repeat the url prefix for your Angular app in every route component and router links. If you set ",(0,o.kt)("strong",{parentName:"p"},"/angular")," in your Angular app activity function for mount when the url starts with this value you'll have to add ",(0,o.kt)("strong",{parentName:"p"},"/angular")," prefix in all links."),(0,o.kt)("p",{parentName:"div"},"You can see several discussions about this issue in ",(0,o.kt)("strong",{parentName:"p"},"single-spa-angular")," GitHub repo: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/single-spa/single-spa-angular/issues/64"},"Router not working without APP_BASE_HREF")," and ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/single-spa/single-spa-angular/issues/62"},"How to handle router links between different single-spa application subrouters")))),(0,o.kt)("h3",{id:"linking-between-applications"},"Linking between applications"),(0,o.kt)("p",null,"To link between applications, simply use ",(0,o.kt)("a",{parentName:"p",href:"https://angular.io/api/router/RouterLink"},(0,o.kt)("inlineCode",{parentName:"a"},"routerLink"))," like normal."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<a routerLink="/other-app">\n  Link to other app\n</a>\n')),(0,o.kt)("h3",{id:"nested-routes"},"Nested routes"),(0,o.kt)("p",null,"Nested routes work exactly the same as they normally do. To create a nested route, add it to your app-routing.module.ts.\nTo link to a nested route, use ",(0,o.kt)("a",{parentName:"p",href:"https://angular.io/api/router/RouterLink"},(0,o.kt)("inlineCode",{parentName:"a"},"routerLink"))," the same way you normally do."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<a routerLink="/my-app/nested-route">\n  Link to nested route\n</a>\n')),(0,o.kt)("h3",{id:"enabling-hash-mode"},"Enabling hash mode"),(0,o.kt)("p",null,"You need to firstly enable hash mode in root-config."),(0,o.kt)("p",null,"If you are using layout html with ",(0,o.kt)("inlineCode",{parentName:"p"},"single-spa-router"),", add ",(0,o.kt)("inlineCode",{parentName:"p"},'mode="hash"')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<single-spa-router mode="hash">\n    ...\n</single-spa-router>\n')),(0,o.kt)("p",null,"If you are registering each route manually, use ",(0,o.kt)("inlineCode",{parentName:"p"},"location.hash")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'\nregisterApplication({\n  name: "@orgName/app1",\n  app: () => System.import("@orgName/app1"),\n  activeWhen: (location) => location.hash.startsWith("#/app1"),\n});\n')),(0,o.kt)("p",null,"Then, enable hash mode in your routing module of angular micro frontend application."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"@NgModule({\n    imports: [RouterModule.forRoot(routes, {useHash: true})],\n    exports: [RouterModule]\n})\n")),(0,o.kt)("h2",{id:"serving"},"Serving"),(0,o.kt)("p",null,"Run the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"npm run serve:single-spa\n")),(0,o.kt)("p",null,"This ",(0,o.kt)("strong",{parentName:"p"},"will not")," open up an HTML file, since single-spa applications all ",(0,o.kt)("a",{parentName:"p",href:"/docs/configuration.html"},"share one html file"),". Instead, go to\n",(0,o.kt)("a",{parentName:"p",href:"http://single-spa-playground.org"},"http://single-spa-playground.org")," and follow the instructions there to verify everything is working and for instructions on creating the shared HTML file."),(0,o.kt)("h2",{id:"building"},"Building"),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"npm run build:single-spa"),", which will create a ",(0,o.kt)("inlineCode",{parentName:"p"},"dist")," directory with your compiled code."),(0,o.kt)("p",null,"In order for the ",(0,o.kt)("a",{parentName:"p",href:"https://webpack.js.org/guides/public-path/#root"},"webpack public path")," to be correctly set for your assets, you should use Angular CLI's ",(0,o.kt)("inlineCode",{parentName:"p"},"--deploy-url")," option. For more information, see ",(0,o.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/47885451/angular-cli-build-using-base-href-and-deploy-url-to-access-assets-on-cdn"},"this Stack Overflow answer")," which shows a few options for how to do that."),(0,o.kt)("h2",{id:"the-single-spa-helpers"},"The single-spa helpers"),(0,o.kt)("h3",{id:"introduction-1"},"Introduction"),(0,o.kt)("p",null,'"single-spa helpers" refers to the in-browser portion of single-spa-angular. The helpers are used by all versions of Angular and\nregardless of whether you are using Angular CLI or not. This is the core of the single-spa-angular library that makes it possible\nfor Angular applications to bootstrap, mount, and unmount. See\n',(0,o.kt)("a",{parentName:"p",href:"/docs/building-applications.html#registered-application-lifecycle"},"single-spa lifecycles")," for more information."),(0,o.kt)("h3",{id:"migrating-from-single-spa-angular3x-to-single-spa-angular4x"},"Migrating from ",(0,o.kt)("a",{parentName:"h3",href:"mailto:single-spa-angular@3.x"},"single-spa-angular@3.x")," to ",(0,o.kt)("a",{parentName:"h3",href:"mailto:single-spa-angular@4.x"},"single-spa-angular@4.x")),(0,o.kt)("p",null,"\u200b\nMigrating from 3.x to 4.x requires only few API updates.\n\u200b"),(0,o.kt)("h4",{id:"packages"},"Packages"),(0,o.kt)("p",null,"\u200b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"npm i --save single-spa-angular@4.0.0\n# Or if you're using yarn\nyarn add single-spa-angular@4.0.0\n")),(0,o.kt)("p",null,"\u200b"),(0,o.kt)("h4",{id:"api-updates"},"API Updates"),(0,o.kt)("p",null,"\u200b\n",(0,o.kt)("inlineCode",{parentName:"p"},"single-spa-angular")," doesn't have a default export anymore, instead you have to import a named ",(0,o.kt)("inlineCode",{parentName:"p"},"singleSpaAngular")," function. Given the following code:\n\u200b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import singleSpaAngular from 'single-spa-angular'; // single-spa-angular@3.x\nimport { singleSpaAngular } from 'single-spa-angular'; // single-spa-angular@4.x\n")),(0,o.kt)("p",null,"\u200b\nAlso, if your application uses routing then you have to import the ",(0,o.kt)("inlineCode",{parentName:"p"},"getSingleSpaExtraProviders")," function. Let's look at the following example, this is how it was in ",(0,o.kt)("inlineCode",{parentName:"p"},"single-spa-angular@3.x"),":\n\u200b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { NgZone } from '@angular/core';\nimport { Router, NavigationStart } from '@angular/router';\nimport singleSpaAngular, { getSingleSpaExtraProviders } from 'single-spa-angular';\n\u200b\nconst lifecycles = singleSpaAngular({\n  bootstrapFunction: singleSpaProps => {\n    singleSpaPropsSubject.next(singleSpaProps);\n    return platformBrowserDynamic(getSingleSpaExtraProviders()).bootstrapModule(AppModule);\n  },\n  template: '<app-root />',\n  Router,\n  NavigationStart,\n  NgZone,\n});\n")),(0,o.kt)("p",null,"\u200b\nAnd this is how it should be in ",(0,o.kt)("inlineCode",{parentName:"p"},"single-spa-angular@4.x"),":\n\u200b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { NgZone } from '@angular/core';\nimport { Router, NavigationStart } from '@angular/router';\nimport { singleSpaAngular, getSingleSpaExtraProviders } from 'single-spa-angular';\n\u200b\nconst lifecycles = singleSpaAngular({\n  bootstrapFunction: singleSpaProps => {\n    singleSpaPropsSubject.next(singleSpaProps);\n    return platformBrowserDynamic(getSingleSpaExtraProviders()).bootstrapModule(AppModule);\n  },\n  template: '<app-root />',\n  Router,\n  NavigationStart,\n  NgZone,\n});\n")),(0,o.kt)("h2",{id:"basic-usage"},"Basic usage"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\nimport { NgZone } from '@angular/core';\nimport { Router, NavigationStart } from '@angular/router';\nimport {\n  singleSpaAngular,\n  getSingleSpaExtraProviders,\n} from 'single-spa-angular';\n\nimport { AppModule } from './app/app.module';\n\nconst lifecycles = singleSpaAngular({\n  bootstrapFunction: singleSpaProps => {\n    return platformBrowserDynamic(getSingleSpaExtraProviders()).bootstrapModule(\n      AppModule,\n    );\n  },\n  template: '<app-root />',\n  Router,\n  NavigationStart,\n  NgZone,\n});\n\nexport const bootstrap = lifecycles.bootstrap;\nexport const mount = lifecycles.mount;\nexport const unmount = lifecycles.unmount;\n")),(0,o.kt)("h3",{id:"full-example"},"Full Example"),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/single-spa/single-spa-angular/blob/master/schematics/ng-add/_files/src/main.single-spa.ts.template#L16"},"this schematic file"),"\nfor a good example of how to use the single-spa helpers."),(0,o.kt)("h3",{id:"options"},"Options"),(0,o.kt)("p",null,"Options are passed to single-spa-angular via the ",(0,o.kt)("inlineCode",{parentName:"p"},"opts")," parameter when calling ",(0,o.kt)("inlineCode",{parentName:"p"},"singleSpaAngular(opts)"),". This happens inside of your ",(0,o.kt)("inlineCode",{parentName:"p"},"main.single-spa.ts")," file."),(0,o.kt)("p",null,"The following options are available:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"bootstrapFunction"),": (required) A function that is given custom props as an argument and returns a promise that resolves with a resolved Angular module that is bootstrapped. Usually, your implementation will look like this: ",(0,o.kt)("inlineCode",{parentName:"li"},"bootstrapFunction: (customProps) => platformBrowserDynamic().bootstrapModule()"),".\nSee ",(0,o.kt)("a",{parentName:"li",href:"https://single-spa.js.org/docs/building-applications.html#custom-props"},"custom props documentation")," for more info on the argument passed to the function."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"template"),": (required) An HTML string that will be put into the DOM Element returned by ",(0,o.kt)("inlineCode",{parentName:"li"},"domElementGetter"),". This template can be anything,\nbut it is recommended that you keeping it simple by making it only one Angular component. For example, ",(0,o.kt)("inlineCode",{parentName:"li"},"<app-root />")," is recommended,\nbut ",(0,o.kt)("inlineCode",{parentName:"li"},"<div><app-root /><span>Hello</span><another-component /></div>")," is allowed. Note that ",(0,o.kt)("inlineCode",{parentName:"li"},"innerHTML")," is used to put the template\nonto the DOM. Also note that when using multiple angular applications simultaneously, you will want to make sure that the component\nselectors provided are unique to avoid collisions. When migrating to single-spa, this template is what is inside of your index.html file's\n",(0,o.kt)("inlineCode",{parentName:"li"},"<body>")," element."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Router"),": (optional) The angular router class. This is required when you are using ",(0,o.kt)("inlineCode",{parentName:"li"},"@angular/router"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"AnimationModule"),": (optional) The animation module class. This is required when you are using BrowserAnimationsModule.\nExample way to import this: ",(0,o.kt)("inlineCode",{parentName:"li"},"import { eAnimationEngine as AnimationModule } from '@angular/animations/browser';"),".\nSee ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/single-spa/single-spa-angular/issues/48"},"Issue 48")," for more details. Note that AnimationModule is no longer needed in Angular 12, so this option can be ignored in Angular >= 12."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"domElementGetter"),": (optional) A function that takes in no arguments and returns a DOMElement. This dom element is where the Angular\napplication will be bootstrapped, mounted, and unmounted. It's recommended to omit this and let single-spa-angular's defaults create and use\na container div.")),(0,o.kt)("h2",{id:"concepts"},"Concepts"),(0,o.kt)("h3",{id:"zonejs"},"ZoneJS"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/angular/zone.js/"},"ZoneJS")," is the library that Angular uses for change detection. You absolutely must have exactly\none instance of the ZoneJS library on the page. ZoneJS will throw errors if you have more than one instance of ZoneJS on the page."),(0,o.kt)("p",null,"The preferred way to ensure only one instance of ZoneJS is loaded on your page is with a script tag in your root-config's HTML file. You should load ZoneJS upfront a single time, before loading SystemJS or any of your microfrontends."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script src="https://cdn.jsdelivr.net/npm/zone.js@0.10.3/dist/zone.min.js"><\/script>\n')),(0,o.kt)("p",null,"Note that having only one instance of ZoneJS is different than having only one zone within that instance. single-spa-angular\nautomatically will ensure that each of your Angular applications has its own isolated, separate zone."),(0,o.kt)("h3",{id:"multiple-applications"},"Multiple applications"),(0,o.kt)("p",null,"When you have multiple apps running side by side, you'll need to make sure that their\n",(0,o.kt)("a",{parentName:"p",href:"https://angular.io/api/core/Directive#selector"},"component selectors")," are unique. When creating a new\nproject, you can have angular-cli do this for you by passing in the ",(0,o.kt)("inlineCode",{parentName:"p"},"--prefix")," option:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"ng new --prefix app2\n")),(0,o.kt)("p",null,"If you did not use the ",(0,o.kt)("inlineCode",{parentName:"p"},"--prefix")," option, you should set the prefix manually:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"For an application called app2, add ",(0,o.kt)("inlineCode",{parentName:"li"},'"prefix": "app2"')," to ",(0,o.kt)("inlineCode",{parentName:"li"},"projects.app2")," inside of the angular.json."),(0,o.kt)("li",{parentName:"ol"},"Go to ",(0,o.kt)("inlineCode",{parentName:"li"},"app.component.ts"),". Modify ",(0,o.kt)("inlineCode",{parentName:"li"},"selector")," to be ",(0,o.kt)("inlineCode",{parentName:"li"},"app2-root"),"."),(0,o.kt)("li",{parentName:"ol"},"Go to ",(0,o.kt)("inlineCode",{parentName:"li"},"main.single-spa.ts"),". Modify ",(0,o.kt)("inlineCode",{parentName:"li"},"template")," to be ",(0,o.kt)("inlineCode",{parentName:"li"},"<app2-root>"),".")),(0,o.kt)("p",null,"Additionally, make sure that ",(0,o.kt)("inlineCode",{parentName:"p"},"reflect-metadata")," is only imported once in the root application and is not imported again in the child applications.\nOtherwise, you might see an ",(0,o.kt)("inlineCode",{parentName:"p"},"No NgModule metadata found")," error.\nSee ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/single-spa/single-spa-angular/issues/2#issuecomment-347864894"},"issue thread")," for more details."),(0,o.kt)("h3",{id:"custom-props"},"Custom Props"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://single-spa.js.org/docs/building-applications.html#custom-props"},"Custom props")," are a way of passing auth or other data to your single-spa\napplications. The custom props are available inside of the ",(0,o.kt)("a",{parentName:"p",href:"#options"},"bootstrapFunction")," passed to singleSpaAngular(). Additionally, if you use the\nangular cli schematic, you may subscribe to the singleSpaPropsSubject in your component, as shown below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// An example showing where you get access to the single-spa props:\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\nimport { singleSpaAngular } from 'single-spa-angular';\n\nconst lifecycles = singleSpaAngular({\n  bootstrapFunction(singleSpaProps) {\n    // Here are the custom props\n    console.log(singleSpaProps);\n    return platformBrowserDynamic().bootstrapModule(AppModule);\n  },\n  // add the other options to singleSpaAngular, too. See \"Basic usage\" for more info\n});\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// If you're using the singleSpaPropsSubject generated by the single-spa-angular schematics,\n// here's an example component that uses the custom props\nimport { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport {\n  singleSpaPropsSubject,\n  SingleSpaProps,\n} from 'src/single-spa/single-spa-props';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css'],\n})\nexport class AppComponent implements OnInit, OnDestroy {\n  singleSpaProps: SingleSpaProps;\n  subscription: Subscription;\n\n  ngOnInit(): void {\n    this.subscription = singleSpaPropsSubject.subscribe(\n      props => (this.singleSpaProps = props),\n    );\n  }\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n\n  // OR if you don't need to access `singleSpaProps` inside the component\n  // then create `Observable` property and use it in template with `async` pipe.\n  singleSpaProps$ = singleSpaPropsSubject.asObservable();\n}\n")),(0,o.kt)("h3",{id:"angular-assets"},"Angular assets"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://angular.io/guide/file-structure#application-source-files"},"Angular assets")," are handled differently within single-spa than within\nother Angular applications. The schematics file called ",(0,o.kt)("inlineCode",{parentName:"p"},"asset-url.ts")," helps you do load assets in a way that works both ways."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"This won't work")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// Doesn't work with single-spa\nconst imageUrl = '/assets/yoshi.png';\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Do this instead")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { assetUrl } from 'src/single-spa/asset-url';\n\n// Works great with single-spa\nconst imageUrl = assetUrl('yoshi.png');\n")),(0,o.kt)("h4",{id:"within-html-templates"},"Within HTML templates"),(0,o.kt)("h5",{id:"option-1"},"Option 1"),(0,o.kt)("p",null,"Add the asset url to your component's class and reference it from the template.\nSee ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/joeldenning/coexisting-angular-microfrontends/blob/0fb9a557705b46349deae5c71b393b71d887e18d/app1/src/app/app.component.ts#L11"},"here"),"\nand ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/joeldenning/coexisting-angular-microfrontends/blob/master/app1/src/app/app.component.html#L9"},"here"),"."),(0,o.kt)("h5",{id:"option-2"},"Option 2"),(0,o.kt)("p",null,"Create an ",(0,o.kt)("a",{parentName:"p",href:"https://angular.io/guide/pipes"},"Angular Pipe")," that lets you calculate the asset url inside of an HTML template:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { Pipe, PipeTransform } from '@angular/core';\nimport { assetUrl } from 'src/single-spa/public-path';\n\n@Pipe({ name: 'assetUrl' })\nexport class AssetUrlPipe implements PipeTransform {\n  transform(value: string): string {\n    return assetUrl(value);\n  }\n}\n")),(0,o.kt)("p",null,"Then use it in your template:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"<img [src]=\"'yoshi.png' | assetUrl\" />\n")),(0,o.kt)("h3",{id:"scripts"},"Scripts"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://angular.io/guide/workspace-config#additional-build-and-test-options"},"Scripts in your angular.json")," are not loaded by single-spa.\nThis is because single-spa applications have to all share an HTML file.\n(",(0,o.kt)("a",{parentName:"p",href:"http://single-spa-playground.org/playground/html-file"},"read more"),"). You can remove the scripts from your angular.json because they\nhave no impact on your single-spa build."),(0,o.kt)("h4",{id:"option-1-1"},"Option 1"),(0,o.kt)("p",null,"Add the script tags directly into your ",(0,o.kt)("a",{parentName:"p",href:"http://single-spa-playground.org/playground/html-file"},"root HTML file"),". This way is easiest.\nThe downside is that all of the scripts get loaded even for routes that don't need them. However, that is generally okay and this\nis the preferred way to do it."),(0,o.kt)("h4",{id:"option-2-1"},"Option 2"),(0,o.kt)("p",null,"If you want the scripts to only be loaded when needed, you can add a custom\n",(0,o.kt)("a",{parentName:"p",href:"/docs/building-applications.html#bootstrap"},"bootstrap lifecycle")," to your code."),(0,o.kt)("p",null,"Note that lazy loading these scripts can actually be worse for performance ",(0,o.kt)("em",{parentName:"p"},"if you always need them"),", since\nthey will start downloading later than if you put them right into the root HTML file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// main.single-spa.ts\n\n// Modify the bootstrap function like so\nexport const bootstrap = [\n  () =>\n    Promise.all([\n      loadScript(\n        'https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js',\n      ),\n      loadScript(\n        'https://cdnjs.cloudflare.com/ajax/libs/datepicker/0.6.5/datepicker.min.js',\n      ),\n    ]),\n  lifecycles.bootstrap,\n];\n\nfunction loadScript(url: string) {\n  return new Promise((resolve, reject) => {\n    const script = document.createElement('script');\n    script.src = url;\n\n    function onLoad() {\n      resolve();\n      cleanup();\n    }\n\n    function onError(event: Event) {\n      reject(event);\n      cleanup();\n    }\n\n    function cleanup() {\n      script.removeEventListener('load', onLoad);\n      script.removeEventListener('error', onError);\n    }\n\n    script.addEventListener('load', onLoad);\n    script.addEventListener('error', onError);\n    document.head.appendChild(script);\n  });\n}\n")),(0,o.kt)("h3",{id:"styles"},"Styles"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://angular.io/guide/workspace-config#additional-build-and-test-options"},"Styles in your angular.json")," will automatically\nbe loaded by single-spa-angular's webpack config, without you having to configure anything."),(0,o.kt)("p",null,"Your component styles will also be loaded like normal without you having to configure anything."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"rebaseRootRelativeCssUrls")),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"https://angular.io/cli/build"},"rebaseRootRelativeCssUrls")," option allows you to keep your css referencing asset urls, which will be rewritten to respect the webpack public path:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-css"},".body-row {\n  background: url('/assets/images/person.jpg') no-repeat right bottom;\n}\n")),(0,o.kt)("p",null,"To do this, you may change your angular.json or run ",(0,o.kt)("inlineCode",{parentName:"p"},"ng build --rebaseRootRelativeCssUrls"),". In the angular.json file, you should modify\narchitect > build > options and update the property ",(0,o.kt)("inlineCode",{parentName:"p"},"rebaseRootRelativeCssUrls")," to be ",(0,o.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,o.kt)("p",null,"Now inside the assets attribute (which is an array) you should add a slash ",(0,o.kt)("strong",{parentName:"p"},'"/"')," to the value of the ",(0,o.kt)("strong",{parentName:"p"},'"output"')," attribute which outputs its external styles (this is optional). Example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "options": {\n    "rebaseRootRelativeCssUrls": true,\n    "assets": [\n      "src/favicon.ico",\n      "src/assets",\n      {\n        "glob": "**/*",\n        "input": "node_modules/@material/dist/collection/assets",\n        "output": "/assets"\n      }\n    ]\n  }\n}\n')),(0,o.kt)("h3",{id:"polyfills"},"Polyfills"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://angular.io/guide/browser-support"},"Polyfills in your angular.json")," are JavaScript code that make your project work in older browsers,\nsuch as IE11."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"The polyfills that you specify in your angular.json file will not be loaded automatically"),". This is because we should only load\npolyfills once in the root HTML file, instead of once per application."),(0,o.kt)("p",null,"To load polyfills, you'll need to follow the instructions in the ",(0,o.kt)("a",{parentName:"p",href:"https://angular.io/guide/browser-support#polyfills-for-non-cli-users"},"Angular documentation for non-CLI users"),".\nEven if you are using Angular CLI, you will need to follow those instructions, since your ",(0,o.kt)("a",{parentName:"p",href:"https://single-spa-playground.org/playground/html-file"},"single-spa root HTML file"),"\nis not using Angular CLI and that's where the polyfills need to go."),(0,o.kt)("p",null,"If you're looking for a quick one-liner, try adding this line near the top of your index.html."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script src="https://unpkg.com/core-js-bundle/minified.js"><\/script>\n')),(0,o.kt)("p",null,"To correct the error ",(0,o.kt)("inlineCode",{parentName:"p"},"It looks like your application or one of its dependencies is using i18n"),"."),(0,o.kt)("p",null,"Install ",(0,o.kt)("inlineCode",{parentName:"p"},"@angular/localize")," in your root-config module"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"npm i @angular/localize\n")),(0,o.kt)("p",null,"Add following import to your root-config.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'import "@angular/localize/init";\n')),(0,o.kt)("h3",{id:"internet-explorer"},"Internet Explorer"),(0,o.kt)("p",null,"If you need to support IE11 or older, do the following:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#polyfills"},"Add core-js polyfill")),(0,o.kt)("li",{parentName:"ul"},"Remove arrow functions from index.html (",(0,o.kt)("a",{parentName:"li",href:"https://github.com/joeldenning/coexisting-angular-microfrontends/commit/22cbb2dc1c15165c39b10aa4019fe517fa88af32#diff-07a3141209aa56f89a0f47490866f94eR34"},"example"),")"),(0,o.kt)("li",{parentName:"ul"},"Change angular.json ",(0,o.kt)("inlineCode",{parentName:"li"},"target")," to ",(0,o.kt)("inlineCode",{parentName:"li"},"es5")," (",(0,o.kt)("a",{parentName:"li",href:"https://github.com/joeldenning/coexisting-angular-microfrontends/commit/22cbb2dc1c15165c39b10aa4019fe517fa88af32#diff-acbfc718bf309f27dd3699a4ad80a2d1R13"},"example"),")")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/joeldenning/coexisting-angular-microfrontends/commit/22cbb2dc1c15165c39b10aa4019fe517fa88af32"},"Full example commit to get IE11 support")),(0,o.kt)("h2",{id:"shared-angular"},"Shared Angular"),(0,o.kt)("p",null,"Sharing one or more instances of Angular between microfrontends provides the following benefits:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Performance improvement, due to reduced amount of javascript to load."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"/docs/recommended-setup#cross-microfrontend-imports"},"Cross-microfrontend imports")," of angular components are possible. (Without a shared instance of Angular, you can still use cross-microfrontend imports of ",(0,o.kt)("a",{parentName:"li",href:"#parcels"},"single-spa parcels"),")")),(0,o.kt)("p",null,"There are two techniques for sharing Angular: ",(0,o.kt)("a",{parentName:"p",href:"/docs/recommended-setup#systemjs"},"SystemJS in-browser modules")," and ",(0,o.kt)("a",{parentName:"p",href:"/docs/recommended-setup#module-federation"},"Module Federation"),". Sharing with SystemJS varies depending on whether you're using Ivy or not. If you're using Ivy, you'll need a ",(0,o.kt)("inlineCode",{parentName:"p"},"POST_R3")," version of the angular core libraries, which are not included in the official Angular packages. You can use the following esm-bundle packages, which provide POST_R3 / ivy-compatible versions that can be shared via SystemJS:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/esm-bundle/angular__core"},"https://github.com/esm-bundle/angular__core")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/esm-bundle/angular__router"},"https://github.com/esm-bundle/angular__router")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/esm-bundle/angular__platform-browser"},"https://github.com/esm-bundle/angular__platform-browser")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/esm-bundle/angular__common"},"https://github.com/esm-bundle/angular__common"))),(0,o.kt)("h2",{id:"angular-elements"},"Angular Elements"),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"This feature is available starting from ",(0,o.kt)("inlineCode",{parentName:"p"},"single-spa-angular@4.4.0"),". You also may need to become familiar with ",(0,o.kt)("a",{parentName:"p",href:"https://angular.io/guide/elements"},"Angular Elements documentation"),"."))),(0,o.kt)("p",null,"Let's start with installing the ",(0,o.kt)("inlineCode",{parentName:"p"},"@angular/elements"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"npm i --save @angular/elements\n# Or if you're using yarn\nyarn add @angular/elements\n")),(0,o.kt)("p",null,"The next step is to edit ",(0,o.kt)("inlineCode",{parentName:"p"},"main.single-spa.ts"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\nimport { singleSpaAngularElements } from 'single-spa-angular/elements';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nconst lifecycles = singleSpaAngularElements({\n  template: '<app-custom-element />',\n  // We can actually not rely on the `zone.js` library, our custom element\n  // will behave itself as a zone-less application.\n  bootstrapFunction: () =>\n    platformBrowserDynamic().bootstrapModule(AppModule, { ngZone: 'noop' }),\n});\n\nexport const bootstrap = lifecycles.bootstrap;\nexport const mount = lifecycles.mount;\nexport const unmount = lifecycles.unmount;\n")),(0,o.kt)("p",null,"Note that the ",(0,o.kt)("inlineCode",{parentName:"p"},"app-custom-element")," selector will be used when defining our ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements"},"custom element"),"."),(0,o.kt)("p",null,"After that, you'll have to edit ",(0,o.kt)("inlineCode",{parentName:"p"},"app.module.ts")," and define a custom tag:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { NgModule, Injector, DoBootstrap } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { createCustomElement } from '@angular/elements';\n\nimport { AppComponent } from './app.component';\n\n@NgModule({\n  imports: [BrowserModule],\n  declarations: [AppComponent],\n})\nexport class AppModule implements DoBootstrap {\n  constructor(private injector: Injector) {}\n\n  ngDoBootstrap(): void {\n    customElements.define(\n      // This tag we've have provided in `options.template` when called `singleSpaAngularElements`.\n      'app-custom-element',\n      createCustomElement(AppComponent, { injector: this.injector }),\n    );\n  }\n}\n")),(0,o.kt)("p",null,"The following options are available to be passed when calling ",(0,o.kt)("inlineCode",{parentName:"p"},"singleSpaAngularElements"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"bootstrapFunction")," (required)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"template")," (required)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"domElementGetter")," (optional)")),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"#options"},"options")," for detailed explanation."),(0,o.kt)("h2",{id:"parcels"},"Parcels"),(0,o.kt)("p",null,"We encourage you to get familiar with the documentation, namely ",(0,o.kt)("a",{parentName:"p",href:"/docs/parcels-overview"},"Parcels overview")," and ",(0,o.kt)("a",{parentName:"p",href:"/docs/parcels-api"},"Parcels API"),". This documentation will give you a basic understanding of what parcels are."),(0,o.kt)("p",null,"Additionally, single-spa-angular provides a ",(0,o.kt)("inlineCode",{parentName:"p"},"<parcel>")," component to make using framework agnostic single-spa parcels easier. This allows you to put the parcel into your component's template, instead of calling ",(0,o.kt)("inlineCode",{parentName:"p"},"mountRootParcel()")," by yourselves."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"single-spa-angular/parcel")," package exports the ",(0,o.kt)("inlineCode",{parentName:"p"},"ParcelModule")," which exports the ",(0,o.kt)("inlineCode",{parentName:"p"},"<parcel>")," component:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// Inside of src/app/app.module.ts\nimport { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { ParcelModule } from 'single-spa-angular/parcel';\n\nimport { AppComponent } from './app.component';\n\n@NgModule({\n  imports: [BrowserModule, ParcelModule],\n  declarations: [AppComponent],\n  bootstrap: [AppComponent],\n})\nexport class AppModule {}\n")),(0,o.kt)("p",null,"The example below shows how you can render React parcels:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// Inside of src/app/app.component.ts\nimport { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { mountRootParcel } from 'single-spa';\n\nimport { config } from './ReactWidget/ReactWidget';\n\n@Component({\n  selector: 'app-root',\n  template:\n    '<parcel [config]=\"config\" [mountParcel]=\"mountRootParcel\"></parcel>',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AppComponent {\n  config = config;\n  mountRootParcel = mountRootParcel;\n}\n")),(0,o.kt)("p",null,"For React, you will need to create a file with the extension ",(0,o.kt)("inlineCode",{parentName:"p"},".tsx"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"// Inside of src/app/ReactWidget/ReactWidget.tsx\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport singleSpaReact from 'single-spa-react';\n\nconst ReactWidget = () => <div>Hello from React!</div>;\n\nexport const config = singleSpaReact({\n  React,\n  ReactDOM,\n  rootComponent: ReactWidget,\n});\n")),(0,o.kt)("h3",{id:"loading-external-components-asynchronously"},"Loading External Components Asynchronously"),(0,o.kt)("p",null,"If your code is part of an import map and you include a global reference to\nsystemjs, you can dynamically import the code using an ",(0,o.kt)("inlineCode",{parentName:"p"},"async")," method."),(0,o.kt)("p",null,"For example, if your import map includes the ",(0,o.kt)("inlineCode",{parentName:"p"},"ReactComponent"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"{\n  imports: {\n    \"@org/react-component\": '/org-react-component.js'\n  }\n}\n")),(0,o.kt)("p",null,"You can dynamically load the component by setting the ",(0,o.kt)("inlineCode",{parentName:"p"},"config")," as an\nasynchronous method that fetches the component."),(0,o.kt)("p",null,"Since some versions of webpack use SystemJS under the hood, you'll need to\nreference the global version."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// Inside of src/app/app.component.ts\nimport { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { mountRootParcel } from 'single-spa';\n\n@Component({\n  selector: 'app-root',\n  template:\n    '<parcel [config]=\"config\" [mountParcel]=\"mountRootParcel\"></parcel>',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AppComponent {\n  async config() {\n    return window.System.import('@org/react-component')\n  }\n  mountRootParcel = mountRootParcel;\n}\n")),(0,o.kt)("h3",{id:"passing-custom-props"},"Passing Custom Props"),(0,o.kt)("p",null,"You can pass any custom props to the parcel by passing an object of props using\nthe ",(0,o.kt)("inlineCode",{parentName:"p"},"customProps")," attribute."),(0,o.kt)("p",null,"For example, if you're rendering a React parcel from an Angular component, you can pass a click handler from Angular into the React parcel:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"// Inside of src/app/ReactWidget/ReactWidget.tsx\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport singleSpaReact from 'single-spa-react';\n\nconst ReactWidget = ({ handleClick }) => <button onClick={handleClick}>Click Me!</button>;\n\nexport const parcelConfig = singleSpaReact({\n  React,\n  ReactDOM,\n  rootComponent: ReactWidget,\n});\n")),(0,o.kt)("p",null,"You can pass a function (or any other value) as a custom prop. To ensure that the functions you pass to the parcel are bound with the correct javascript context, use the ",(0,o.kt)("inlineCode",{parentName:"p"},"handleClick = () => {")," syntax when defining your functions."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// Inside of src/app/app.component.ts\nimport { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { mountRootParcel } from 'single-spa';\n\nimport { config } from './ReactWidget/ReactWidget';\n\n@Component({\n  selector: 'app-root',\n  template:\n    '<parcel [config]=\"config\" [customProps]=\"parcelProps\" [mountParcel]=\"mountRootParcel\"></parcel>',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AppComponent {\n  config = config;\n  mountRootParcel = mountRootParcel;\n\n  handleClick = () => {\n    alert('Hello World');\n  }\n\n  parcelProps = {\n    handleClick = this.handleClick\n  }\n}\n")),(0,o.kt)("h2",{id:"zone-less-applications"},"Zone-less applications"),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"This feature is available starting from ",(0,o.kt)("inlineCode",{parentName:"p"},"single-spa-angular@4.1"),"."))),(0,o.kt)("p",null,"It's possible to develop Angular applications that don't rely on ",(0,o.kt)("inlineCode",{parentName:"p"},"zone.js")," library, these applications are called ",(0,o.kt)("em",{parentName:"p"},"zone-less"),". You have to run change detection manually in ",(0,o.kt)("em",{parentName:"p"},"zone-less")," applications through ",(0,o.kt)("inlineCode",{parentName:"p"},"ApplicationRef.tick()")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"ChangeDetectorRef.detectChanges()"),". You can find more info in ",(0,o.kt)("a",{parentName:"p",href:"https://angular.io/guide/zone#noopzone"},"Angular NoopZone docs"),"."),(0,o.kt)("p",null,"The point is that you do not need to load ",(0,o.kt)("inlineCode",{parentName:"p"},"zone.js")," library in your root HTML file. As Angular docs mention that you should have a comprehensive knowledge of change detection to develop such applications. Let's start by ",(0,o.kt)("em",{parentName:"p"},"nooping")," zone when bootstrapping module:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { singleSpaAngular } from 'single-spa-angular';\n\nconst lifecycles = singleSpaAngular({\n  bootstrapFunction: () =>\n    platformBrowserDynamic().bootstrapModule(AppModule, { ngZone: 'noop' }),\n  template: '<app-root />',\n  NgZone: 'noop',\n});\n")),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"We must specify ",(0,o.kt)("inlineCode",{parentName:"p"},"noop")," ",(0,o.kt)("em",{parentName:"p"},"twice"),": when bootstrapping ",(0,o.kt)("inlineCode",{parentName:"p"},"AppModule"),", and setting ",(0,o.kt)("inlineCode",{parentName:"p"},"NgZone")," property to ",(0,o.kt)("inlineCode",{parentName:"p"},"noop"),". This tells Angular and single-spa-angular that we're not going to use zones."))),(0,o.kt)("h3",{id:"routing-in-zone-less-applications"},"Routing in zone-less applications"),(0,o.kt)("p",null,"Since routing is managed by single-spa and there is no zone that tells Angular that some asynchronous event has occured, then we need to tell Angular when to run change detection if routing occurs. Let's look at the below code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { ApplicationRef } from '@angular/core';\nimport { Router, NavigationStart } from '@angular/router';\nimport { singleSpaAngular } from 'single-spa-angular';\n\nconst lifecycles = singleSpaAngular({\n  bootstrapFunction: async () => {\n    const ngModuleRef = await platformBrowserDynamic().bootstrapModule(\n      AppModule,\n      { ngZone: 'noop' },\n    );\n\n    const appRef = ngModuleRef.injector.get(ApplicationRef);\n    const listener = () => appRef.tick();\n    window.addEventListener('popstate', listener);\n\n    ngModuleRef.onDestroy(() => {\n      window.removeEventListener('popstate', listener);\n    });\n\n    return ngModuleRef;\n  },\n  template: '<app-root />',\n  NgZone: 'noop',\n  Router,\n  NavigationStart,\n});\n")),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("inlineCode",{parentName:"p"},"single-spa-angular@4.x")," ",(0,o.kt)("strong",{parentName:"p"},"requires")," calling ",(0,o.kt)("inlineCode",{parentName:"p"},"getSingleSpaExtraProviders")," function in applications that have routing. Do not call this function in ",(0,o.kt)("em",{parentName:"p"},"zone-less")," application."))),(0,o.kt)("h2",{id:"inter-app-communication-via-rxjs"},"Inter-app communication via RxJS"),(0,o.kt)("p",null,"First of all, check out this ",(0,o.kt)("a",{parentName:"p",href:"/docs/recommended-setup#inter-app-communication"},"Inter-app communication guide"),"."),(0,o.kt)("p",null,"It's possible to setup a communication between microfrontends via RxJS using ",(0,o.kt)("a",{parentName:"p",href:"/docs/recommended-setup#cross-microfrontend-imports"},"cross microfrontend imports"),"."),(0,o.kt)("p",null,"We can not create complex abstractions, but simply export the ",(0,o.kt)("inlineCode",{parentName:"p"},"Subject"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// Inside of @org/api\nimport { ReplaySubject } from 'rxjs';\nimport { User } from '@org/models';\n\n// `1` means that we want to buffer the last emitted value\nexport const userSubject$ = new ReplaySubject<User>(1);\n")),(0,o.kt)("p",null,"And then you just need to import this ",(0,o.kt)("inlineCode",{parentName:"p"},"Subject")," into the microfrontend application:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// Inside of @org/app1 single-spa application\nimport { userSubject$ } from '@org/api';\nimport { User } from '@org/models';\n\nuserSubject$.subscribe(user => {\n  // ...\n});\n\nuserSubject$.next(newUser);\n")),(0,o.kt)("p",null,"Also, you should remember that ",(0,o.kt)("inlineCode",{parentName:"p"},"@org/api"),' should be an "isolated" dependency, for example the Nrwl Nx library, where each library is in the "libs" folder and you import it via TypeScript paths.'),(0,o.kt)("p",null,"Every application that uses this library should add it to its Webpack config as an external dependency:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const singleSpaAngularWebpack = require('single-spa-angular/lib/webpack')\n  .default;\n\nmodule.exports = (config, options) => {\n  const singleSpaWebpackConfig = singleSpaAngularWebpack(config, options);\n  singleSpaWebpackConfig.externals = [/^@org\\/api$/];\n  return singleSpaWebpackConfig;\n};\n")),(0,o.kt)("p",null,"But this library should be part of root application bundle and ",(0,o.kt)("a",{parentName:"p",href:"/docs/recommended-setup/#sharing-with-import-maps"},"shared with import maps"),", for example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "imports": {\n    "@org/api": "http://localhost:8080/api.js"\n  }\n}\n')))}m.isMDXComponent=!0}}]);